"use client"

import { useLayoutEffect, useEffect, useState } from 'react';
import { useRouter } from 'next/navigation';
import dynamic from 'next/dynamic';

const ARScene = dynamic(() => import('./ARScene'), { ssr: false });



export default function Index() {
    const [viewMode, setViewMode] = useState<'mapview' | 'AR'>('AR');
    const router = useRouter();
    const handleBack = async () => {
        router.push('/map');
    };

    return (
        <>
            <div className="relative w-screen h-screen max-w-[1200px] mx-auto">
                {/* 標題欄 */}
                <div className="fixed top-0 left-0 right-0 bg-white p-4 flex justify-between items-center z-10 shadow-md">
                    <div className="w-10"></div>
                    <h1 className="text-lg  text-black">猿來有車位</h1>
                    <button
                        className="w-7 h-7 bg-black rounded-sm flex items-center justify-center transition-transform duration-300 active:bg-white active:text-black"
                        aria-label="關閉"
                    >
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-full h-full">
                            <line strokeWidth={1} x1="18" y1="6" x2="6" y2="18"></line>
                            <line strokeWidth={1} x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>

                {/* AR按鈕 */}
                <div className="absolute right-4 top-[150px] z-10">
                    <div className="bg-white rounded-2xl shadow-md p-1 flex flex-col">
                        <button
                            className={`p-2 w-10 h-10 rounded-full transition-colors duration-300 ${viewMode === 'mapview' ? 'bg-[#5AB4C5] text-white' : 'text-[#5AB4C5]'
                                }`}
                            aria-label="地圖模式"
                        >
                            {icon_map}
                        </button>
                        <button
                            className={`p-2 w-10 h-10 rounded-full transition-colors duration-300 ${viewMode === 'AR' ? 'bg-[#5AB4C5] text-white' : 'text-[#5AB4C5]'
                                }`}
                            onClick={() => handleBack()}
                            aria-label="AR模式"
                        >
                            {icon_ar}
                        </button>
                    </div>
                </div>
                <ARScene />
            </div>

        </>
    )
}


const icon_map = (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
    <path d="M6 19V20C6 20.2833 5.90417 20.5208 5.7125 20.7125C5.52083 20.9042 5.28333 21 5 21H4C3.71667 21 3.47917 20.9042 3.2875 20.7125C3.09583 20.5208 3 20.2833 3 20V12L5.1 6C5.2 5.7 5.37917 5.45833 5.6375 5.275C5.89583 5.09167 6.18333 5 6.5 5H17.5C17.8167 5 18.1042 5.09167 18.3625 5.275C18.6208 5.45833 18.8 5.7 18.9 6L21 12V20C21 20.2833 20.9042 20.5208 20.7125 20.7125C20.5208 20.9042 20.2833 21 20 21H19C18.7167 21 18.4792 20.9042 18.2875 20.7125C18.0958 20.5208 18 20.2833 18 20V19H6ZM5.8 10H18.2L17.15 7H6.85L5.8 10ZM7.5 16C7.91667 16 8.27083 15.8542 8.5625 15.5625C8.85417 15.2708 9 14.9167 9 14.5C9 14.0833 8.85417 13.7292 8.5625 13.4375C8.27083 13.1458 7.91667 13 7.5 13C7.08333 13 6.72917 13.1458 6.4375 13.4375C6.14583 13.7292 6 14.0833 6 14.5C6 14.9167 6.14583 15.2708 6.4375 15.5625C6.72917 15.8542 7.08333 16 7.5 16ZM16.5 16C16.9167 16 17.2708 15.8542 17.5625 15.5625C17.8542 15.2708 18 14.9167 18 14.5C18 14.0833 17.8542 13.7292 17.5625 13.4375C17.2708 13.1458 16.9167 13 16.5 13C16.0833 13 15.7292 13.1458 15.4375 13.4375C15.1458 13.7292 15 14.0833 15 14.5C15 14.9167 15.1458 15.2708 15.4375 15.5625C15.7292 15.8542 16.0833 16 16.5 16ZM5 17H19V12H5V17Z" />
</svg>)


const icon_ar = (
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
        <g clip-path="url(#clip0_154_4068)">
            <path d="M20.0167 11.4223C20.0167 12.83 20.0133 14.2379 20.0208 15.6457C20.0218 15.8279 19.9759 15.9275 19.8032 16.0132C17.2701 17.2709 14.7403 18.536 12.2127 19.8049C12.0604 19.8813 11.9432 19.8801 11.7914 19.8037C9.26455 18.5353 6.73549 17.2706 4.20307 16.0129C4.03424 15.9292 3.97949 15.8367 3.97973 15.65C3.98621 12.8343 3.98669 10.0186 3.97901 7.20323C3.97853 7.01022 4.04625 6.9274 4.21003 6.84698C6.74294 5.60683 9.27295 4.36115 11.8013 3.11164C11.9427 3.04179 12.0515 3.03578 12.1975 3.10804C14.7326 4.36188 17.2701 5.61067 19.8104 6.8537C19.9716 6.93268 20.0218 7.02318 20.0208 7.19914C20.0131 8.60686 20.0165 10.0148 20.0165 11.4225L20.0167 11.4223ZM6.87886 7.76665C6.93578 7.80434 6.95331 7.81874 6.97324 7.82858C8.60845 8.63878 10.2429 9.45043 11.882 10.2532C11.9557 10.2892 12.0825 10.2717 12.1618 10.2328C13.7657 9.44683 15.3664 8.65415 16.967 7.86195C17.0119 7.83962 17.0508 7.8053 17.1017 7.77025C17.0635 7.74432 17.0458 7.72872 17.0251 7.71839C15.3988 6.91851 13.7732 6.11647 12.1426 5.32572C12.0554 5.28347 11.9077 5.30123 11.8147 5.34588C10.8865 5.79239 9.96436 6.25091 9.04001 6.70558C8.33179 7.05391 7.6231 7.40103 6.8791 7.76641L6.87886 7.76665ZM10.9917 17.1516C10.9917 15.4709 10.9939 13.831 10.984 12.1912C10.9836 12.1206 10.8853 12.0229 10.809 11.985C9.2804 11.224 7.74846 10.4697 6.21676 9.71473C6.15432 9.68401 6.08852 9.65976 5.99654 9.62063C5.99654 9.71641 5.99654 9.78603 5.99654 9.85541C5.99654 11.3834 5.99942 12.9116 5.99221 14.4396C5.99149 14.6076 6.04529 14.6902 6.19394 14.7639C7.71988 15.5196 9.24197 16.2828 10.7653 17.0438C10.8279 17.075 10.8918 17.104 10.9917 17.1516ZM13.009 17.1432C13.0719 17.1211 13.095 17.1155 13.1157 17.1052C14.6959 16.3164 16.2746 15.5244 17.858 14.7418C17.998 14.6727 18.0059 14.5817 18.0057 14.4564C18.0037 12.9121 18.0045 11.3678 18.0037 9.82348C18.0037 9.76395 17.9951 9.70465 17.9893 9.62687C17.9324 9.65064 17.8959 9.6636 17.8616 9.68064C16.2943 10.4527 14.7285 11.2276 13.1582 11.9931C13.0196 12.0608 13.0071 12.1473 13.0073 12.2738C13.01 13.706 13.009 15.1384 13.009 16.5706C13.009 16.7528 13.009 16.935 13.009 17.1432Z" />
            <path d="M1.99347 1.9817V5.98398H0.0117188V0H5.97906V1.9817H1.99347Z" />
            <path d="M22.0114 1.99272H18.0205V0.00454712H23.9996V5.98348H22.0114V1.99272Z" />
            <path d="M0 23.9909V18.0158H1.98775V21.9941H5.97815V23.9909H0Z" />
            <path d="M23.997 24H18.02V22.0099H22.0047V18.0093H23.997V23.9998V24Z" />
        </g>
        <defs>
            <clipPath id="clip0_154_4068">
                <rect width="24" height="24" />
            </clipPath>
        </defs>
    </svg>

)